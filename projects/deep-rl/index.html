<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Deep Reinforcement Learning in Discrete Action Space | Minsuan Teh </title> <meta name="author" content="Minsuan Teh"> <meta name="description" content="Solving CartPole and Acrobot using Deep Q-Networks and REINFORCE"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://minsuan96.github.io/projects/deep-rl/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Minsuan</span> Teh </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/experiences/">experiences </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Deep Reinforcement Learning in Discrete Action Space</h1> <p class="post-description">Solving CartPole and Acrobot using Deep Q-Networks and REINFORCE</p> </header> <article> <p><em>Disclaimer: The code for this project is not accessible to the public as it constitutes one of the assignments for the <a href="https://opencourse.inf.ed.ac.uk/rl" rel="external nofollow noopener" target="_blank">Reinforcement Learning</a> course at <a href="https://www.ed.ac.uk/" rel="external nofollow noopener" target="_blank">The University of Edinburgh</a>.</em></p> <ul> <li> <a href="#the-environment">The Environment</a> <ul> <li><a href="#cartpole">Cartpole</a></li> <li><a href="#acrobot">Acrobot</a></li> </ul> </li> <li> <a href="#setting-up-the-agent">Setting up the Agent</a> <ul> <li><a href="#dqn-agent">DQN Agent</a></li> <li><a href="#reinforce-agent">REINFORCE Agent</a></li> </ul> </li> <li> <a href="#training-the-agent">Training the Agent</a> <ul> <li><a href="#using-dqn">Using DQN</a></li> <li><a href="#using-reinforce">Using REINFORCE</a></li> </ul> </li> <li> <a href="#results">Results</a> <ul> <li> <a href="#cartpole-1">Cartpole</a> <ul> <li><a href="#dqn">DQN</a></li> <li><a href="#reinforce">REINFORCE</a></li> </ul> </li> <li> <a href="#acrobot-1">Acrobot</a> <ul> <li><a href="#dqn-1">DQN</a></li> <li><a href="#reinforce-1">REINFORCE</a></li> </ul> </li> </ul> </li> </ul> <h1 id="the-environment">The Environment</h1> <div class="container"> <div class="row justify-content-center"> <div class="col"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cartpole-480.webp 480w,/assets/img/cartpole-800.webp 800w,/assets/img/cartpole-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/cartpole.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/acrobot-480.webp 480w,/assets/img/acrobot-800.webp 800w,/assets/img/acrobot-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/acrobot.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </div> <p>This project tackles two classic control problems: the <a href="https://gymnasium.farama.org/environments/classic_control/cart_pole/" rel="external nofollow noopener" target="_blank">Cartpole</a> and <a href="https://gymnasium.farama.org/environments/classic_control/acrobot/" rel="external nofollow noopener" target="_blank">Acrobot</a> environments.</p> <h2 id="cartpole">Cartpole</h2> <p>The Cart Pole environment, part of the Classic Control environments, simulates a scenario where a pole is attached by an un-actuated joint to a cart, which moves along a frictionless track. The goal is to balance the pole by applying forces in the left or right direction to the cart.</p> <p>At the start of each episode, the pole is placed upright on the cart, and the agent must take actions to prevent the pole from falling over. The action space is discrete with two possible actions:</p> <ul> <li>0: Push the cart to the left</li> <li>1: Push the cart to the right</li> </ul> <p>The observation space is a continuous array with four elements:</p> <ol> <li>Cart Position: Ranges from -4.8 to 4.8</li> <li>Cart Velocity: Can take any real value</li> <li>Pole Angle: Ranges from approximately -24° to 24°</li> <li>Pole Angular Velocity: Can take any real value</li> </ol> <p>However, episode termination occurs if the cart position leaves the range of -2.4 to 2.4 or if the pole angle exceeds approximately ±12°.</p> <p>The agent receives a reward of +1 for each step taken, including the termination step, as the goal is to keep the pole upright for as long as possible. The episode ends if any of the following conditions are met:</p> <ol> <li>The pole angle exceeds approximately ±12°.</li> <li>The cart position reaches the edge of the display, exceeding ±2.4.</li> <li>The episode length exceeds a predefined limit of 500 steps.</li> </ol> <h2 id="acrobot">Acrobot</h2> <p>The Acrobot environment is a classic control problem based on <a href="https://papers.nips.cc/paper/1995/hash/8f1d43620bc6bb580df6e80b0dc05c48-Abstract.html" rel="external nofollow noopener" target="_blank">Sutton’s work</a> in reinforcement learning. It features a system consisting of two links connected linearly to form a chain, with one end of the chain fixed. The joint between the two links is actuated, and the goal is to swing the free end of the chain above a given height while starting from an initial state where both links are hanging downwards.</p> <p>In the Acrobot environment, the action space is discrete, with three possible actions representing the torque applied on the actuated joint between the two links:</p> <ul> <li>0: Apply -1 torque to the actuated joint</li> <li>1: Apply 0 torque to the actuated joint</li> <li>2: Apply 1 torque to the actuated joint</li> </ul> <p>The observation space is a continuous array with six elements providing information about the rotational joint angles and their angular velocities. These observations include:</p> <ol> <li>Cosine and sine of theta1 (angle of the first joint)</li> <li>Cosine and sine of theta2 (angle of the second joint relative to the first)</li> <li>Angular velocity of theta1</li> <li>Angular velocity of theta2</li> </ol> <p>The episode ends when either the free end of the chain reaches a designated target height or the episode length exceeds a predefined limit. The reward structure encourages the system to reach the target height in as few steps as possible, with a reward of -1 given for each step that does not reach the goal. Achieving the target height results in termination with a reward of 0.</p> <hr> <h1 id="setting-up-the-agent">Setting up the Agent</h1> <h2 id="dqn-agent">DQN Agent</h2> <h2 id="reinforce-agent">REINFORCE Agent</h2> <hr> <h1 id="training-the-agent">Training the Agent</h1> <h2 id="using-dqn">Using DQN</h2> <h2 id="using-reinforce">Using REINFORCE</h2> <hr> <h1 id="results">Results</h1> <h2 id="cartpole-1">Cartpole</h2> <h3 id="dqn">DQN</h3> <div class="container"> <div class="row justify-content-center"> <div class="col"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/-480.webp 480w,/assets/img/-800.webp 800w,/assets/img/-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/-480.webp 480w,/assets/img/-800.webp 800w,/assets/img/-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/-480.webp 480w,/assets/img/-800.webp 800w,/assets/img/-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> DQN Agent trained with , and episodes. </div> </div> <h3 id="reinforce">REINFORCE</h3> <h2 id="acrobot-1">Acrobot</h2> <h3 id="dqn-1">DQN</h3> <h3 id="reinforce-1">REINFORCE</h3> </article> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2024 Minsuan Teh. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a>. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>